Follow pdbj_README.txt in this directory from:

ftp://ftp.pdbj.org/mine/00README.txt
See ./pdbj_Mine/00README.txt

Read: http://shifteleven.com/articles/2008/03/21/installing-postgresql-on-leopard-using-macports

sudo SystemStarter stop PostgreSQL
sudo SystemStarter start PostgreSQL

# stella
setenv PGDATA /Users/jd/opt/postgresql84/defaultdb
setenv PGBIN /Users/jd/opt/bin
# nmr
setenv PGDATA /pgdata
setenv PGBIN /usr/local/pgsql/bin


Configuration at:
$PGDATA/postgresql.conf
e.g. shows default port to be 5432
max_locks_per_transaction set to 5120 before I could drop pdbj schema; needed to restart.

Log:\
sudo tail -f $PGDATA/logfile

-- 1 -- Use Fix in http://shifteleven.com/articles/2008/03/21/installing-postgresql-on-leopard-using-macports
on: "The solution to the /dev/null error:"

sudo mkdir /Users/postgres
sudo chown postgres:postgres /Users/postgres
sudo dscl . -create /Users/postgres UserShell /bin/tcsh
sudo dscl . -create /Users/postgres NFSHomeDirectory /Users/postgres

--  2 -- Fix problem with getline. described here:
http://www.stereoplex.com/2008/feb/select5/error-compiling-postgresql-83-on-leopard-rl_comple/
stella:
./configure --prefix=/Users/jd/opt --with-python --with-libxml --with-libxslt --with-libedit-preferred
nmr:
./configure --prefix=/usr/local/pgsql --with-python --with-libxml --with-libxslt --with-libedit-preferred

To create a database instance, after install do
 sudo mkdir -p $PGDATA
 sudo chown postgres:postgres $PGDATA
 sudo su postgres -c 'initdb -D $PGDATA'

To tweak your DBMS, consider increasing kern.sysv.shmmax by adding an increased kern.sysv.shmmax .. to /etc/sysctl.conf

Connect as postgres unix user:
	psql
	create role akinjo LOGIN CREATEDB SUPERUSER;
	create role nrgcing1 LOGIN CREATEDB SUPERUSER;
	create database nrgcing;
	alter database nrgcing owner to nrgcing1;

	create role casdcing1 LOGIN CREATEDB SUPERUSER;
	create database casdcing;
	alter database casdcing owner to casdcing1;

Connect as jd unix user:
	createdb nrgcing
	psql -l


-- Getting started help:
\? from the psql monitor
\l list db
\dt' list tables
\d atom list a table called atom.


- add PGDATA to exclusion list of spotlight and TM.
- Create file /etc/sysctl.conf with 1G (100 Mb now) and reboot:
NOTE THIS BELOW CRASHED TOMCAT JAVA ENVIRONMENT. SWITCHED BACK TO DEFAULT SETTINGS.
From: http://serverfault.com/questions/10226/how-to-set-the-shmmax-parameter-on-mac-os-x

stack overflow/biostar.stackexchange.com 'ns kijken.

# This one is working on Stella
kern.sysv.shmmax=524288000
kern.sysv.shmmin=1
kern.sysv.shmmni=64
kern.sysv.shmseg=16
kern.sysv.semmns=130
kern.sysv.shmall=131072000
kern.sysv.maxproc=2048
kern.maxprocperuid=512

On nmr using (fink recommends):
kern.sysv.shmmax=8388608
kern.sysv.shmmin=1
kern.sysv.shmmni=64
kern.sysv.shmseg=8
kern.sysv.shmall=32768

# Recommendations from psql for mac osx is:
kern.sysv.shmmax=4194304
kern.sysv.shmmin=1
kern.sysv.shmmni=32
kern.sysv.shmseg=8
kern.sysv.shmall=1024 # SHMALL is measured in 4 kB pages on this platform.
# In all OS X versions, you'll need to reboot to make changes in the shared memory parameters take effect.

or for all shared memory related settings:
sysctl -a | grep shm
Or do on line but settings will not persist.
jd:nmr/~/ sudo sysctl -w kern.sysv.shmmax=104857600 DID THIS WORK?

It failed to reload the weekly run with setting of 256 as suggested so increased to:
max_locks_per_transaction = 1024
This was running 93 Mb (675 Mb uncompressed SQL).
Tuning is related to setting the kernel resources:
http://www.postgresql.org/docs/8.4/static/kernel-resources.html#SYSVIPC
There must be something wrong in my settings as the postgres program only shows 2 Mb Real memory and 30 Mb Virtual.
Way too small to be useful.
Ok documentation found at:
http://www.postgresql.org/docs/current/static/runtime-config-resource.html
Looks like it really needs to be adjusted:

shared_buffers

Set a password:
http://www.postgresql.org/docs/8.3/interactive/libpq-pgpass.html

For automatic start/stop follow instructions at:
http://ripary.com/postgresql.html
using:
$CINGROOT/scripts/sql/PostgreSQL copied to:
/Library/StartupItems/PostgreSQL/PostgreSQL
'''You can disable automatic startup at any time by editing /etc/hostconfig.'''